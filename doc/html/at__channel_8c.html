<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Sierra RIL: hardware/sierra/swiril/at_channel.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Sierra RIL
   &#160;<span id="projectnumber">R0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ac7df9380ba1d5d3d602df81a60439d8.html">hardware</a></li><li class="navelem"><a class="el" href="dir_d7ff66cbb8db4abd845e01a316f08f99.html">sierra</a></li><li class="navelem"><a class="el" href="dir_71aacc67c1644f0f8503fe9a71fe9d5a.html">swiril</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">at_channel.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;telephony/ril.h&gt;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;pthread.h&gt;</code><br/>
<code>#include &lt;ctype.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;errno.h&gt;</code><br/>
<code>#include &lt;termios.h&gt;</code><br/>
<code>#include &lt;fcntl.h&gt;</code><br/>
<code>#include &lt;stdbool.h&gt;</code><br/>
<code>#include &lt;sys/time.h&gt;</code><br/>
<code>#include &lt;time.h&gt;</code><br/>
<code>#include &lt;unistd.h&gt;</code><br/>
<code>#include &lt;poll.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="at__channel_8h_source.html">at_channel.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="at__tok_8h_source.html">at_tok.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="at__misc_8h_source.html">at_misc.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="swiril__main_8h_source.html">swiril_main.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="swiril__log_8h_source.html">swiril_log.h</a>&quot;</code><br/>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structatcontext.html">atcontext</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a7ce0df38eb467e59f209470c8f5ac4e6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a7ce0df38eb467e59f209470c8f5ac4e6">LOG_TAG</a>&#160;&#160;&#160;&quot;AT&quot;</td></tr>
<tr class="separator:a7ce0df38eb467e59f209470c8f5ac4e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a432a5edfc3681710cb1451a5688d6d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a0a432a5edfc3681710cb1451a5688d6d">NUM_ELEMS</a>(x)&#160;&#160;&#160;(sizeof(x)/sizeof(x[0]))</td></tr>
<tr class="separator:a0a432a5edfc3681710cb1451a5688d6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9ee68ca93ad6113f27ba77f149eb612"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#ac9ee68ca93ad6113f27ba77f149eb612">MAX_AT_RESPONSE</a>&#160;&#160;&#160;(8 * 1024)</td></tr>
<tr class="separator:ac9ee68ca93ad6113f27ba77f149eb612"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a313beb6f4c27d182f9448c03657c2f7d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a313beb6f4c27d182f9448c03657c2f7d">HANDSHAKE_RETRY_COUNT</a>&#160;&#160;&#160;8</td></tr>
<tr class="separator:a313beb6f4c27d182f9448c03657c2f7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1caca4a2f43b09eda7bf1ed49ed5b6db"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a1caca4a2f43b09eda7bf1ed49ed5b6db">HANDSHAKE_TIMEOUT_MSEC</a>&#160;&#160;&#160;250</td></tr>
<tr class="separator:a1caca4a2f43b09eda7bf1ed49ed5b6db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85c14b6b51538cce28fe2bd6eb4b95b3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a85c14b6b51538cce28fe2bd6eb4b95b3">DEFAULT_AT_TIMEOUT_MSEC</a>&#160;&#160;&#160;(3 * 60 * 1000)</td></tr>
<tr class="separator:a85c14b6b51538cce28fe2bd6eb4b95b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af33eb86a5eaf5af2aa859b3408702d19"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#af33eb86a5eaf5af2aa859b3408702d19">AT_ONE_SECOND</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:af33eb86a5eaf5af2aa859b3408702d19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab214f2670692491ed732fa5e7dadb811"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#ab214f2670692491ed732fa5e7dadb811">SENSITIVE_AT_CMD_LOG</a>(<a class="el" href="qaGobiApiWdsTest_8c.html#a08168b3b626551a7d7249deb563ac043">s</a>)</td></tr>
<tr class="separator:ab214f2670692491ed732fa5e7dadb811"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0eec093d89f38d27d26e241c63504660"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a0eec093d89f38d27d26e241c63504660">at_port_teardown</a> (void)</td></tr>
<tr class="separator:a0eec093d89f38d27d26e241c63504660"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3cc4f264f0e134b530daff0b5287d70"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#af3cc4f264f0e134b530daff0b5287d70">writeCtrlZ</a> (const char *<a class="el" href="qaGobiApiWdsTest_8c.html#a08168b3b626551a7d7249deb563ac043">s</a>)</td></tr>
<tr class="separator:af3cc4f264f0e134b530daff0b5287d70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7def5c388e42f699d96446b4b5d2e66"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#ad7def5c388e42f699d96446b4b5d2e66">writeline</a> (const char *<a class="el" href="qaGobiApiWdsTest_8c.html#a08168b3b626551a7d7249deb563ac043">s</a>)</td></tr>
<tr class="separator:ad7def5c388e42f699d96446b4b5d2e66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0f198d95339ed69995be1243734f05c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#ad0f198d95339ed69995be1243734f05c">onReaderClosed</a> ()</td></tr>
<tr class="separator:ad0f198d95339ed69995be1243734f05c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a4aeabe90ec2cc421fbc313dcb89f46"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a2a4aeabe90ec2cc421fbc313dcb89f46">make_key</a> ()</td></tr>
<tr class="separator:a2a4aeabe90ec2cc421fbc313dcb89f46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfa0e128b7d8d1b129e4dda0aa361090"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#acfa0e128b7d8d1b129e4dda0aa361090">setAtContext</a> (struct <a class="el" href="structatcontext.html">atcontext</a> *ac)</td></tr>
<tr class="separator:acfa0e128b7d8d1b129e4dda0aa361090"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07c97f1f4a0334a7d05b434985745945"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a07c97f1f4a0334a7d05b434985745945">initializeAtContext</a> ()</td></tr>
<tr class="separator:a07c97f1f4a0334a7d05b434985745945"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af59a6305f374664de28bfafbe3e8e03e"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structatcontext.html">atcontext</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#af59a6305f374664de28bfafbe3e8e03e">getAtContext</a> ()</td></tr>
<tr class="separator:af59a6305f374664de28bfafbe3e8e03e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f4e32c4b964b31e5620774aaa1fca9b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a3f4e32c4b964b31e5620774aaa1fca9b">at_make_default_channel</a> (void)</td></tr>
<tr class="separator:a3f4e32c4b964b31e5620774aaa1fca9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9531ec49f22ca518ee1080dd8cfba1ae"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a9531ec49f22ca518ee1080dd8cfba1ae">setTimespecRelative</a> (struct timespec *p_ts, long long msec)</td></tr>
<tr class="separator:a9531ec49f22ca518ee1080dd8cfba1ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5cdae034eadbc483a0ae625cc3d5a98"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#aa5cdae034eadbc483a0ae625cc3d5a98">sleepMsec</a> (long long msec)</td></tr>
<tr class="separator:aa5cdae034eadbc483a0ae625cc3d5a98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a894d096b98405d903ac75c7f1274be08"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a894d096b98405d903ac75c7f1274be08">addIntermediate</a> (const char *line)</td></tr>
<tr class="separator:a894d096b98405d903ac75c7f1274be08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85bddd92f574bac69134a97cd90146f9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a85bddd92f574bac69134a97cd90146f9">isFinalResponseError</a> (const char *line)</td></tr>
<tr class="separator:a85bddd92f574bac69134a97cd90146f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ab8111e23d92da208d408325a0b39f4"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a7ab8111e23d92da208d408325a0b39f4">isFinalResponseSuccess</a> (const char *line)</td></tr>
<tr class="separator:a7ab8111e23d92da208d408325a0b39f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9371a61b88c9e04bfe7d46ddf0c62ed3"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a9371a61b88c9e04bfe7d46ddf0c62ed3">isFinalResponse</a> (const char *line)</td></tr>
<tr class="separator:a9371a61b88c9e04bfe7d46ddf0c62ed3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87cb55c2876479ce4d3ba026a61b158c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a87cb55c2876479ce4d3ba026a61b158c">isSMSUnsolicited</a> (const char *line)</td></tr>
<tr class="separator:a87cb55c2876479ce4d3ba026a61b158c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4a73fae09499cf6d5bb9167793b6b55"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#af4a73fae09499cf6d5bb9167793b6b55">handleFinalResponse</a> (const char *line)</td></tr>
<tr class="separator:af4a73fae09499cf6d5bb9167793b6b55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7c56a9338ac440609ddcf3d9fa7b6b6"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#ab7c56a9338ac440609ddcf3d9fa7b6b6">handleUnsolicited</a> (const char *line)</td></tr>
<tr class="separator:ab7c56a9338ac440609ddcf3d9fa7b6b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a52688cc9ffe0a1d787bc50e6e4d4c1"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a9a52688cc9ffe0a1d787bc50e6e4d4c1">processLine</a> (const char *line)</td></tr>
<tr class="separator:a9a52688cc9ffe0a1d787bc50e6e4d4c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c0989b2033b8d49e2a9c829d8b36352"><td class="memItemLeft" align="right" valign="top">static char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a4c0989b2033b8d49e2a9c829d8b36352">findNextEOL</a> (char *cur)</td></tr>
<tr class="separator:a4c0989b2033b8d49e2a9c829d8b36352"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e8290f609a7ce09e2e999f893883020"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a4e8290f609a7ce09e2e999f893883020">readline</a> ()</td></tr>
<tr class="separator:a4e8290f609a7ce09e2e999f893883020"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87762370bcaf0d90297552d8efa40847"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a87762370bcaf0d90297552d8efa40847">readerLoop</a> (void *arg)</td></tr>
<tr class="separator:a87762370bcaf0d90297552d8efa40847"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a7956d22a59c867bdf8295f5c23c0a0"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a5a7956d22a59c867bdf8295f5c23c0a0">clearPendingCommand</a> ()</td></tr>
<tr class="separator:a5a7956d22a59c867bdf8295f5c23c0a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02b15d674b2913e0ce78621971f3b1bf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a02b15d674b2913e0ce78621971f3b1bf">at_timeout_handler</a> (void)</td></tr>
<tr class="separator:a02b15d674b2913e0ce78621971f3b1bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa8098adf26eb378fd21fb18164e8a1e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#aaa8098adf26eb378fd21fb18164e8a1e">clearPendingQueryNetworksCmd</a> ()</td></tr>
<tr class="separator:aaa8098adf26eb378fd21fb18164e8a1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc9dc5b99bed8293459d51e8be120b9a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#afc9dc5b99bed8293459d51e8be120b9a">at_open</a> (char *ttynamep, <a class="el" href="at__channel_8h.html#a3c8c5e0e1806c3784c47511ca278347f">ATUnsolHandler</a> h, int atopendelay, int closetime)</td></tr>
<tr class="separator:afc9dc5b99bed8293459d51e8be120b9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a270f09c39e44153c8b5edbf9140383d0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a270f09c39e44153c8b5edbf9140383d0">at_close</a> (void)</td></tr>
<tr class="separator:a270f09c39e44153c8b5edbf9140383d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3865396a1ca11e9f8183239c72ae8c71"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structATResponse.html">ATResponse</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a3865396a1ca11e9f8183239c72ae8c71">at_response_new</a> ()</td></tr>
<tr class="separator:a3865396a1ca11e9f8183239c72ae8c71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2b26946a4700003a23fc6bc0f7a4166"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#af2b26946a4700003a23fc6bc0f7a4166">at_response_free</a> (<a class="el" href="structATResponse.html">ATResponse</a> *p_response)</td></tr>
<tr class="separator:af2b26946a4700003a23fc6bc0f7a4166"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a0a26384019ec198afd7c35bdc54c42"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a6a0a26384019ec198afd7c35bdc54c42">reverseIntermediates</a> (<a class="el" href="structATResponse.html">ATResponse</a> *p_response)</td></tr>
<tr class="separator:a6a0a26384019ec198afd7c35bdc54c42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00cd3ceac68bddf2dd0e36701afdf5db"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a00cd3ceac68bddf2dd0e36701afdf5db">at_close_timer</a> (void *paramp)</td></tr>
<tr class="separator:a00cd3ceac68bddf2dd0e36701afdf5db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68d3e36c6f618dd3a09d7f676d65708d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a68d3e36c6f618dd3a09d7f676d65708d">at_port_setup</a> (void)</td></tr>
<tr class="separator:a68d3e36c6f618dd3a09d7f676d65708d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d8c5c3f1cb7facd36951646174e441d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a5d8c5c3f1cb7facd36951646174e441d">at_query_networks_multi_timeout</a> (const char *command, const char *responsePrefix, <a class="el" href="structATResponse.html">ATResponse</a> **pp_outResponse, long long timeoutMsec)</td></tr>
<tr class="separator:a5d8c5c3f1cb7facd36951646174e441d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa09539e2daccb5d6c75f81e304e4b33b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#aa09539e2daccb5d6c75f81e304e4b33b">at_send_command_full_nolock</a> (const char *command, <a class="el" href="at__channel_8h.html#a67f3a7297871f1ddf35d8c1f1216c7b1">ATCommandType</a> type, const char *responsePrefix, const char *smspdu, long long timeoutMsec, <a class="el" href="structATResponse.html">ATResponse</a> **pp_outResponse)</td></tr>
<tr class="separator:aa09539e2daccb5d6c75f81e304e4b33b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae55e756f75381fd47474259e1929313f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#ae55e756f75381fd47474259e1929313f">at_send_command_full</a> (const char *command, <a class="el" href="at__channel_8h.html#a67f3a7297871f1ddf35d8c1f1216c7b1">ATCommandType</a> type, const char *responsePrefix, const char *smspdu, long long timeoutMsec, <a class="el" href="structATResponse.html">ATResponse</a> **pp_outResponse)</td></tr>
<tr class="separator:ae55e756f75381fd47474259e1929313f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac58e20f87bad5f9299114d71acd00553"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#ac58e20f87bad5f9299114d71acd00553">at_send_escape</a> (void)</td></tr>
<tr class="separator:ac58e20f87bad5f9299114d71acd00553"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a304966636fe48de095d3316dbafa1a97"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a304966636fe48de095d3316dbafa1a97">at_send_command_with_timeout</a> (const char *command, <a class="el" href="structATResponse.html">ATResponse</a> **pp_outResponse, int timeoutMsec)</td></tr>
<tr class="separator:a304966636fe48de095d3316dbafa1a97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1ff8670e4ddc54c93b4c6367b83f199"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#ad1ff8670e4ddc54c93b4c6367b83f199">at_send_command</a> (const char *command, <a class="el" href="structATResponse.html">ATResponse</a> **pp_outResponse)</td></tr>
<tr class="separator:ad1ff8670e4ddc54c93b4c6367b83f199"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a477a7dcfc7af15c01605fd5f2f9bbf15"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a477a7dcfc7af15c01605fd5f2f9bbf15">at_send_command_singleline</a> (const char *command, const char *responsePrefix, <a class="el" href="structATResponse.html">ATResponse</a> **pp_outResponse)</td></tr>
<tr class="separator:a477a7dcfc7af15c01605fd5f2f9bbf15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab38ca29075586f417f66489a58d132cd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#ab38ca29075586f417f66489a58d132cd">at_send_command_singleline_with_timeout</a> (const char *command, const char *responsePrefix, <a class="el" href="structATResponse.html">ATResponse</a> **pp_outResponse, int timeoutMsec)</td></tr>
<tr class="separator:ab38ca29075586f417f66489a58d132cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b7724f521cc0a9746307c36bfb1b806"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a8b7724f521cc0a9746307c36bfb1b806">at_send_command_numeric</a> (const char *command, <a class="el" href="structATResponse.html">ATResponse</a> **pp_outResponse)</td></tr>
<tr class="separator:a8b7724f521cc0a9746307c36bfb1b806"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6cf64913b20b115e4e945b21dc59f04"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#ad6cf64913b20b115e4e945b21dc59f04">at_send_command_sms</a> (const char *command, const char *pdu, const char *responsePrefix, <a class="el" href="structATResponse.html">ATResponse</a> **pp_outResponse)</td></tr>
<tr class="separator:ad6cf64913b20b115e4e945b21dc59f04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a290b59d34c670e4c93d096f03e6a4aec"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a290b59d34c670e4c93d096f03e6a4aec">at_send_command_multiline</a> (const char *command, const char *responsePrefix, <a class="el" href="structATResponse.html">ATResponse</a> **pp_outResponse)</td></tr>
<tr class="separator:a290b59d34c670e4c93d096f03e6a4aec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca2cbc0f255b61a1f65acb258e7bde7b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#aca2cbc0f255b61a1f65acb258e7bde7b">at_send_command_multivalue</a> (const char *command, const char *responsePrefix, <a class="el" href="structATResponse.html">ATResponse</a> **pp_outResponse)</td></tr>
<tr class="separator:aca2cbc0f255b61a1f65acb258e7bde7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0f657c81df74e3aa5643523831f358c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#aa0f657c81df74e3aa5643523831f358c">at_set_timeout_msec</a> (int timeout)</td></tr>
<tr class="separator:aa0f657c81df74e3aa5643523831f358c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af558c4c512b7c1dbc9d9dc02646da192"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#af558c4c512b7c1dbc9d9dc02646da192">at_set_on_timeout</a> (void(*onTimeout)(void))</td></tr>
<tr class="separator:af558c4c512b7c1dbc9d9dc02646da192"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6a9e2016f3e72f45290bc01f8ebc3f0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#ae6a9e2016f3e72f45290bc01f8ebc3f0">at_set_on_reader_closed</a> (void(*onClose)(void))</td></tr>
<tr class="separator:ae6a9e2016f3e72f45290bc01f8ebc3f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93ee5c2bc8901225f9eb6bad9a7da123"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a93ee5c2bc8901225f9eb6bad9a7da123">at_handshake</a> ()</td></tr>
<tr class="separator:a93ee5c2bc8901225f9eb6bad9a7da123"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d7191c7a2ce7c65d5d367b8718fece4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="at__channel_8h.html#a893974a3b0f5ad3cc398fc18bd6d44e7">AT_CME_Error</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a3d7191c7a2ce7c65d5d367b8718fece4">at_get_cme_error</a> (const <a class="el" href="structATResponse.html">ATResponse</a> *p_response)</td></tr>
<tr class="separator:a3d7191c7a2ce7c65d5d367b8718fece4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a636417b18fa820071365cd8d0af28f2a"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a636417b18fa820071365cd8d0af28f2a">sensitive_at_cmd</a> = false</td></tr>
<tr class="separator:a636417b18fa820071365cd8d0af28f2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84e1be1253b70d5b9f9d577108c578aa"><td class="memItemLeft" align="right" valign="top">static const struct timeval&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a84e1be1253b70d5b9f9d577108c578aa">TIMER_TICK_INTERVAL</a> = {<a class="el" href="at__channel_8c.html#af33eb86a5eaf5af2aa859b3408702d19">AT_ONE_SECOND</a>, 0}</td></tr>
<tr class="separator:a84e1be1253b70d5b9f9d577108c578aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bf4f5e4ce12845114ea57566070f928"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a6bf4f5e4ce12845114ea57566070f928">g_query_in_progress</a></td></tr>
<tr class="separator:a6bf4f5e4ce12845114ea57566070f928"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98ff31e93b8abd3ff89ac227817ca8d4"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structatcontext.html">atcontext</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a98ff31e93b8abd3ff89ac227817ca8d4">s_defaultAtContext</a> = <a class="el" href="aaglobal_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></td></tr>
<tr class="separator:a98ff31e93b8abd3ff89ac227817ca8d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac256ecc480ba7aaf877e07aed0a791bf"><td class="memItemLeft" align="right" valign="top">static pthread_key_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#ac256ecc480ba7aaf877e07aed0a791bf">key</a></td></tr>
<tr class="separator:ac256ecc480ba7aaf877e07aed0a791bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82c482fb4128b8458fca1eb0218b6f7a"><td class="memItemLeft" align="right" valign="top">static pthread_once_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a82c482fb4128b8458fca1eb0218b6f7a">key_once</a> = PTHREAD_ONCE_INIT</td></tr>
<tr class="separator:a82c482fb4128b8458fca1eb0218b6f7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac739c16ac6bad7da15fb3548d92ff85d"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#ac739c16ac6bad7da15fb3548d92ff85d">s_finalResponsesError</a> []</td></tr>
<tr class="separator:ac739c16ac6bad7da15fb3548d92ff85d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e84d544c560b5d9fe5bb5f408eb0399"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#a5e84d544c560b5d9fe5bb5f408eb0399">s_finalResponsesSuccess</a> []</td></tr>
<tr class="separator:a5e84d544c560b5d9fe5bb5f408eb0399"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2df3cce584e12a7ed33a377afb137f9"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="at__channel_8c.html#aa2df3cce584e12a7ed33a377afb137f9">s_smsUnsoliciteds</a> []</td></tr>
<tr class="separator:aa2df3cce584e12a7ed33a377afb137f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="af33eb86a5eaf5af2aa859b3408702d19"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AT_ONE_SECOND&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a85c14b6b51538cce28fe2bd6eb4b95b3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEFAULT_AT_TIMEOUT_MSEC&#160;&#160;&#160;(3 * 60 * 1000)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a313beb6f4c27d182f9448c03657c2f7d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HANDSHAKE_RETRY_COUNT&#160;&#160;&#160;8</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a1caca4a2f43b09eda7bf1ed49ed5b6db"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HANDSHAKE_TIMEOUT_MSEC&#160;&#160;&#160;250</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a7ce0df38eb467e59f209470c8f5ac4e6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LOG_TAG&#160;&#160;&#160;&quot;AT&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ac9ee68ca93ad6113f27ba77f149eb612"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_AT_RESPONSE&#160;&#160;&#160;(8 * 1024)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a0a432a5edfc3681710cb1451a5688d6d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NUM_ELEMS</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;(sizeof(x)/sizeof(x[0]))</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ab214f2670692491ed732fa5e7dadb811"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SENSITIVE_AT_CMD_LOG</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="qaGobiApiWdsTest_8c.html#a08168b3b626551a7d7249deb563ac043">s</a></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">({ \</div>
<div class="line">    if((!strncasecmp(<a class="code" href="qaGobiApiWdsTest_8c.html#a08168b3b626551a7d7249deb563ac043">s</a>,<span class="stringliteral">&quot;AT!ENTERCND=&quot;</span>,12)) || \</div>
<div class="line">       (!strncasecmp(<a class="code" href="qaGobiApiWdsTest_8c.html#a08168b3b626551a7d7249deb563ac043">s</a>,<span class="stringliteral">&quot;AT!UNLOCK=&quot;</span>,10))) { <a class="code" href="at__channel_8c.html#a636417b18fa820071365cd8d0af28f2a">\</a></div>
<div class="line"><a class="code" href="at__channel_8c.html#a636417b18fa820071365cd8d0af28f2a">        sensitive_at_cmd</a> = <span class="keyword">true</span>; \</div>
<div class="line">        LOGI(<span class="stringliteral">&quot;---Modem unlock command\n&quot;</span>); \</div>
<div class="line">    } \</div>
<div class="line">    else <span class="keywordflow">if</span> (!strncasecmp(<a class="code" href="qaGobiApiWdsTest_8c.html#a08168b3b626551a7d7249deb563ac043">s</a>,<span class="stringliteral">&quot;AT!NV?&quot;</span>,6)) { <a class="code" href="at__channel_8c.html#a636417b18fa820071365cd8d0af28f2a">\</a></div>
<div class="line"><a class="code" href="at__channel_8c.html#a636417b18fa820071365cd8d0af28f2a">        sensitive_at_cmd</a> = <span class="keyword">true</span>; \</div>
<div class="line">        LOGI(<span class="stringliteral">&quot;---NV Read/Write command\n&quot;</span>); \</div>
<div class="line">    } \</div>
<div class="line">    else { \</div>
<div class="line">        LOGI(<span class="stringliteral">&quot;--- %s&quot;</span>, <a class="code" href="qaGobiApiWdsTest_8c.html#a08168b3b626551a7d7249deb563ac043">s</a>); \</div>
<div class="line">    } \</div>
<div class="line">})</div>
<div class="ttc" id="qaGobiApiWdsTest_8c_html_a08168b3b626551a7d7249deb563ac043"><div class="ttname"><a href="qaGobiApiWdsTest_8c.html#a08168b3b626551a7d7249deb563ac043">s</a></div><div class="ttdeci">local struct ssdatasession_params s</div><div class="ttdef"><b>Definition:</b> qaGobiApiWdsTest.c:34</div></div>
<div class="ttc" id="at__channel_8c_html_a636417b18fa820071365cd8d0af28f2a"><div class="ttname"><a href="at__channel_8c.html#a636417b18fa820071365cd8d0af28f2a">sensitive_at_cmd</a></div><div class="ttdeci">static bool sensitive_at_cmd</div><div class="ttdef"><b>Definition:</b> at_channel.c:74</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a894d096b98405d903ac75c7f1274be08"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void addIntermediate </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>line</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add an intermediate response to sp_response. </p>

</div>
</div>
<a class="anchor" id="a270f09c39e44153c8b5edbf9140383d0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void at_close </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close the AT command mechanism. </p>
<p>Not to be confused with closing the AT Command port to the modem. That is handled elsewhere (at_port_teardown). This function is called when there is no longer a need to send and receive AT commands</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">none</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none </dd></dl>
<dl class="section note"><dt>Note</dt><dd>This entry is only called from within the <a class="el" href="swiril__main_8c.html#a679603e7bdee99b0b1dd56fca01ce79e" title="Initialize the file descriptor and execute the requests from queue. ">queueRunner()</a> loop and is called whenever a condition occurs where the AT package should be closed. </dd></dl>

</div>
</div>
<a class="anchor" id="a00cd3ceac68bddf2dd0e36701afdf5db"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void at_close_timer </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>paramp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>AT function to decrement an active timer and close the AT port when the timer reaches zero. </p>
<p>Runs in the context of <a class="el" href="swiril__main_8c.html#a679603e7bdee99b0b1dd56fca01ce79e" title="Initialize the file descriptor and execute the requests from queue. ">queueRunner()</a> as an enqueued function which guarantees no race condition exists between the setting of this timer and its periodic decrementing</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">paramp</td><td><ul>
<li>Optional void pointer to accept incoming parameters from the caller who enqueued this function. Not used in this function</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>None</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Runs in the context of the <a class="el" href="swiril__main_8c.html#a679603e7bdee99b0b1dd56fca01ce79e" title="Initialize the file descriptor and execute the requests from queue. ">queueRunner()</a> thread </dd></dl>

</div>
</div>
<a class="anchor" id="a3d7191c7a2ce7c65d5d367b8718fece4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="at__channel_8h.html#a893974a3b0f5ad3cc398fc18bd6d44e7">AT_CME_Error</a> at_get_cme_error </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structATResponse.html">ATResponse</a> *&#160;</td>
          <td class="paramname"><em>p_response</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns error code from response. </p>
<p>Assumes AT+CMEE=1 (numeric) mode. </p>

</div>
</div>
<a class="anchor" id="a93ee5c2bc8901225f9eb6bad9a7da123"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int at_handshake </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Periodically issue an AT command and wait for a response. </p>
<p>Used to ensure channel has start up and is active. </p>

</div>
</div>
<a class="anchor" id="a3f4e32c4b964b31e5620774aaa1fca9b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void at_make_default_channel </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function will make the current AT thread the default channel, meaning that calls from a thread that is not a queuerunner will be executed in this context. </p>

</div>
</div>
<a class="anchor" id="afc9dc5b99bed8293459d51e8be120b9a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int at_open </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>ttynamep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="at__channel_8h.html#a3c8c5e0e1806c3784c47511ca278347f">ATUnsolHandler</a>&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>atopendelay</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>closetime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This entry opens the AT handler, first initializing some values in the control block and then starting the AT reader loop thread. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ttynamep</td><td>Pointer to a string representing the TTY to use for AT commands </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">unsolhandlerp</td><td>Pointer to a function for handling incoming unsolicited AT command traffic from the modem </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atopendelay</td><td>Delay value (ms) to use whenever the AT command port is opened in preparation for initiating an AT command. Changes to this value require that <a class="el" href="at__channel_8c.html#a270f09c39e44153c8b5edbf9140383d0" title="Close the AT command mechanism. ">at_close()</a> be called followed by a subsequent call to <a class="el" href="at__channel_8c.html#afc9dc5b99bed8293459d51e8be120b9a" title="This entry opens the AT handler, first initializing some values in the control block and then startin...">at_open()</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">closetime</td><td>The delay to use for the AT port closing timer in seconds. Converted to ticks inside this function prior to use. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 - Function executed without errors -1 - Function had errors. See logs for details</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function is not concerned with opening the AT command port to the modem. That happens within this file whenever there are AT commands to send to the modem. This function initializes the internal variables required for the AT mechanism to work. </dd></dl>

</div>
</div>
<a class="anchor" id="a68d3e36c6f618dd3a09d7f676d65708d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int at_port_setup </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Prepare the AT Command port, opening it and adjusting the tty settings for our use. </p>
<p>If the port is already open don't do anything except re-arm the port closure timeout</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">none</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 - Successfully opened the port -1 - An error occurred opening the port </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Called from the context of the command thread always </dd></dl>

</div>
</div>
<a class="anchor" id="a0eec093d89f38d27d26e241c63504660"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void at_port_teardown </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close the AT port and do any local clean up that is required. </p>
<p>The AT port opens when commands need to be sent and is closed when the response has been received. Therefore, closing the AT port does not mean the reader thread needs to terminate.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">none</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Always called from the context of the command (RIL) thread </dd></dl>

</div>
</div>
<a class="anchor" id="a5d8c5c3f1cb7facd36951646174e441d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int at_query_networks_multi_timeout </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>command</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>responsePrefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structATResponse.html">ATResponse</a> **&#160;</td>
          <td class="paramname"><em>pp_outResponse</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long&#160;</td>
          <td class="paramname"><em>timeoutMsec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Used for AT+COPS=? only This is done to abort the command in between if necessary. </p>

</div>
</div>
<a class="anchor" id="af2b26946a4700003a23fc6bc0f7a4166"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void at_response_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structATResponse.html">ATResponse</a> *&#160;</td>
          <td class="paramname"><em>p_response</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a3865396a1ca11e9f8183239c72ae8c71"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="structATResponse.html">ATResponse</a>* at_response_new </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ad1ff8670e4ddc54c93b4c6367b83f199"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int at_send_command </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>command</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structATResponse.html">ATResponse</a> **&#160;</td>
          <td class="paramname"><em>pp_outResponse</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Issue a single normal AT command with no intermediate response expected. </p>
<p>"command" should not include . pp_outResponse can be NULL.</p>
<p>if non-NULL, the resulting <a class="el" href="structATResponse.html" title="Free this with at_response_free(). ">ATResponse</a> * must be eventually freed with at_response_free. </p>

</div>
</div>
<a class="anchor" id="ae55e756f75381fd47474259e1929313f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int at_send_command_full </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>command</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="at__channel_8h.html#a67f3a7297871f1ddf35d8c1f1216c7b1">ATCommandType</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>responsePrefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>smspdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long&#160;</td>
          <td class="paramname"><em>timeoutMsec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structATResponse.html">ATResponse</a> **&#160;</td>
          <td class="paramname"><em>pp_outResponse</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Internal send_command implementation. </p>
<p>timeoutMsec == 0 means infinite timeout. </p>

</div>
</div>
<a class="anchor" id="aa09539e2daccb5d6c75f81e304e4b33b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int at_send_command_full_nolock </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>command</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="at__channel_8h.html#a67f3a7297871f1ddf35d8c1f1216c7b1">ATCommandType</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>responsePrefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>smspdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long&#160;</td>
          <td class="paramname"><em>timeoutMsec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structATResponse.html">ATResponse</a> **&#160;</td>
          <td class="paramname"><em>pp_outResponse</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Internal send_command implementation. </p>
<p>Doesn't lock or call the timeout callback. Must be called with commandmutex already locked</p>
<p>All send command calls ultimately pass through this one</p>
<p>timeoutMsec == 0 means infinite timeout. </p>

</div>
</div>
<a class="anchor" id="a290b59d34c670e4c93d096f03e6a4aec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int at_send_command_multiline </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>command</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>responsePrefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structATResponse.html">ATResponse</a> **&#160;</td>
          <td class="paramname"><em>pp_outResponse</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aca2cbc0f255b61a1f65acb258e7bde7b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int at_send_command_multivalue </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>command</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>responsePrefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structATResponse.html">ATResponse</a> **&#160;</td>
          <td class="paramname"><em>pp_outResponse</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a8b7724f521cc0a9746307c36bfb1b806"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int at_send_command_numeric </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>command</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structATResponse.html">ATResponse</a> **&#160;</td>
          <td class="paramname"><em>pp_outResponse</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a477a7dcfc7af15c01605fd5f2f9bbf15"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int at_send_command_singleline </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>command</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>responsePrefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structATResponse.html">ATResponse</a> **&#160;</td>
          <td class="paramname"><em>pp_outResponse</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ab38ca29075586f417f66489a58d132cd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int at_send_command_singleline_with_timeout </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>command</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>responsePrefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structATResponse.html">ATResponse</a> **&#160;</td>
          <td class="paramname"><em>pp_outResponse</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timeoutMsec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ad6cf64913b20b115e4e945b21dc59f04"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int at_send_command_sms </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>command</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>responsePrefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structATResponse.html">ATResponse</a> **&#160;</td>
          <td class="paramname"><em>pp_outResponse</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a304966636fe48de095d3316dbafa1a97"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int at_send_command_with_timeout </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>command</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structATResponse.html">ATResponse</a> **&#160;</td>
          <td class="paramname"><em>pp_outResponse</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timeoutMsec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ac58e20f87bad5f9299114d71acd00553"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void at_send_escape </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ae6a9e2016f3e72f45290bc01f8ebc3f0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void at_set_on_reader_closed </td>
          <td>(</td>
          <td class="paramtype">void(*)(void)&#160;</td>
          <td class="paramname"><em>onClose</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="af558c4c512b7c1dbc9d9dc02646da192"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void at_set_on_timeout </td>
          <td>(</td>
          <td class="paramtype">void(*)(void)&#160;</td>
          <td class="paramname"><em>onTimeout</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This callback is invoked on the command thread. </p>

</div>
</div>
<a class="anchor" id="aa0f657c81df74e3aa5643523831f358c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void at_set_timeout_msec </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timeout</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the default timeout. </p>
<p>Let it be reasonably high, some commands take their time. Default is 10 minutes. </p>

</div>
</div>
<a class="anchor" id="a02b15d674b2913e0ce78621971f3b1bf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void at_timeout_handler </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a5a7956d22a59c867bdf8295f5c23c0a0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void clearPendingCommand </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aaa8098adf26eb378fd21fb18164e8a1e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clearPendingQueryNetworksCmd </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a4c0989b2033b8d49e2a9c829d8b36352"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static char* findNextEOL </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>cur</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns a pointer to the end of the next line, special-cases the "&gt; " SMS prompt. </p>
<p>returns NULL if there is no complete line. </p>

</div>
</div>
<a class="anchor" id="af59a6305f374664de28bfafbe3e8e03e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structatcontext.html">atcontext</a>* getAtContext </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="af4a73fae09499cf6d5bb9167793b6b55"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void handleFinalResponse </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>line</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>handleFinalResponse - signal the command-initiator that the final part of the AT response has been received. </p>
<p>The effect of this is to unblock the command side which runs in the queueRunner thread's context. Assumes s_commandmutex is held </p>

</div>
</div>
<a class="anchor" id="ab7c56a9338ac440609ddcf3d9fa7b6b6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void handleUnsolicited </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>line</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a07c97f1f4a0334a7d05b434985745945"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int initializeAtContext </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a9371a61b88c9e04bfe7d46ddf0c62ed3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int isFinalResponse </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>line</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns 1 if line is a final response, either error or success. </p>
<p>See 27.007 annex B. WARNING: NO CARRIER and others are sometimes unsolicited. </p>

</div>
</div>
<a class="anchor" id="a85bddd92f574bac69134a97cd90146f9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int isFinalResponseError </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>line</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a7ab8111e23d92da208d408325a0b39f4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int isFinalResponseSuccess </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>line</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a87cb55c2876479ce4d3ba026a61b158c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int isSMSUnsolicited </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>line</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a2a4aeabe90ec2cc421fbc313dcb89f46"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void make_key </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ad0f198d95339ed69995be1243734f05c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void onReaderClosed </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a9a52688cc9ffe0a1d787bc50e6e4d4c1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void processLine </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>line</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a87762370bcaf0d90297552d8efa40847"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void* readerLoop </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Thread for reading traffic from the AT command port. </p>
<p>This thread blocks on the read and when AT traffic originates from the modem the thread unblocks, reads the traffic and processes the response.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">arg</td><td>Used to set the context for this thread</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NULL, always</dd></dl>
<dl class="section note"><dt>Note</dt><dd>: The thread must also synchronize with calls to at_send_command... The serial port for AT traffic is closed unless there is a need to actively send a command. The calling thread opens the serial port and then unblocks this thread until the response is handled </dd></dl>

</div>
</div>
<a class="anchor" id="a4e8290f609a7ce09e2e999f893883020"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static const char* readline </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reads a line from the AT channel, returns NULL on timeout. </p>
<p>Assumes it has exclusive read access to the FD.</p>
<p>This line is valid only until the next call to readline.</p>
<p>This function exists because as of writing, android libc does not have buffered stdio. </p>

</div>
</div>
<a class="anchor" id="a6a0a26384019ec198afd7c35bdc54c42"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void reverseIntermediates </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structATResponse.html">ATResponse</a> *&#160;</td>
          <td class="paramname"><em>p_response</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The line reader places the intermediate responses in reverse order, here we flip them back. </p>

</div>
</div>
<a class="anchor" id="acfa0e128b7d8d1b129e4dda0aa361090"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void setAtContext </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structatcontext.html">atcontext</a> *&#160;</td>
          <td class="paramname"><em>ac</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the atcontext pointer. </p>
<p>Useful for sub-threads that needs to hold the same state information.</p>
<p>The caller IS responsible for freeing any memory already allocated for any previous atcontexts. </p>

</div>
</div>
<a class="anchor" id="a9531ec49f22ca518ee1080dd8cfba1ae"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void setTimespecRelative </td>
          <td>(</td>
          <td class="paramtype">struct timespec *&#160;</td>
          <td class="paramname"><em>p_ts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long&#160;</td>
          <td class="paramname"><em>msec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aa5cdae034eadbc483a0ae625cc3d5a98"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void sleepMsec </td>
          <td>(</td>
          <td class="paramtype">long long&#160;</td>
          <td class="paramname"><em>msec</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="af3cc4f264f0e134b530daff0b5287d70"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int writeCtrlZ </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ad7def5c388e42f699d96446b4b5d2e66"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int writeline </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sends string s to the radio with a  appended. </p>
<p>Returns AT_ERROR_* on error, 0 on success.</p>
<p>This function exists because as of writing, android libc does not have buffered stdio. </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a6bf4f5e4ce12845114ea57566070f928"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool g_query_in_progress</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ac256ecc480ba7aaf877e07aed0a791bf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pthread_key_t key</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a82c482fb4128b8458fca1eb0218b6f7a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pthread_once_t key_once = PTHREAD_ONCE_INIT</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a98ff31e93b8abd3ff89ac227817ca8d4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structatcontext.html">atcontext</a>* s_defaultAtContext = <a class="el" href="aaglobal_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ac739c16ac6bad7da15fb3548d92ff85d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char* s_finalResponsesError[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    <span class="stringliteral">&quot;ERROR&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;+CMS ERROR:&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;+CME ERROR:&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;NO CARRIER&quot;</span>,      </div>
<div class="line">    <span class="stringliteral">&quot;NO ANSWER&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;NO DIALTONE&quot;</span>,</div>
<div class="line"></div>
<div class="line">    </div>
<div class="line">    <span class="stringliteral">&quot;*CNTI: +CME ERROR:&quot;</span>  </div>
<div class="line">}</div>
</div><!-- fragment -->
<p>Returns 1 if line is a final response indicating error. </p>
<p>See 27.007 annex B. WARNING: NO CARRIER and others are sometimes unsolicited. </p>

</div>
</div>
<a class="anchor" id="a5e84d544c560b5d9fe5bb5f408eb0399"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char* s_finalResponsesSuccess[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    <span class="stringliteral">&quot;OK&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;CONNECT&quot;</span>       </div>
<div class="line">}</div>
</div><!-- fragment -->
<p>Returns 1 if line is a final response indicating success. </p>
<p>See 27.007 annex B. WARNING: NO CARRIER and others are sometimes unsolicited. </p>

</div>
</div>
<a class="anchor" id="aa2df3cce584e12a7ed33a377afb137f9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char* s_smsUnsoliciteds[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    <span class="stringliteral">&quot;+CMT:&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;+CDS:&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;+CBM:&quot;</span></div>
<div class="line">}</div>
</div><!-- fragment -->
<p>Returns 1 if line is the first line in (what will be) a two-line SMS unsolicited response. </p>

</div>
</div>
<a class="anchor" id="a636417b18fa820071365cd8d0af28f2a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool sensitive_at_cmd = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a84e1be1253b70d5b9f9d577108c578aa"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct timeval TIMER_TICK_INTERVAL = {<a class="el" href="at__channel_8c.html#af33eb86a5eaf5af2aa859b3408702d19">AT_ONE_SECOND</a>, 0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jul 11 2017 08:56:11 for Sierra RIL by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
